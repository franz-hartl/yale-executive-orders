<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="AI-powered analysis of Presidential Executive Orders and their specific impacts on higher education institutions. Real-time intelligence for university compliance and planning.">
    <title>Higher Education Executive Order Tracker | AI-Powered University Compliance</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ðŸ“œ</text></svg>">
    <!-- Accessibility enhancement -->
    <script>
        // Add focus outline script - ensures focus visibility for keyboard navigation
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Tab') {
                document.body.classList.add('user-is-tabbing');
            }
        });
        document.addEventListener('mousedown', function() {
            document.body.classList.remove('user-is-tabbing');
        });
    </script>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.1/css/all.min.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        /* Accessibility styles */
        .user-is-tabbing :focus {
            outline: 2px solid #2563eb !important;
            outline-offset: 2px !important;
        }
        
        .sr-only {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            white-space: nowrap;
            border-width: 0;
        }
        
        :root {
            /* Yale Official Colors */
            --yale-blue: #00356B; /* Official Yale Blue (PMS 648C equivalent) */
            --yale-blue-light: #286DC0; /* Higher intensity blue (PMS 660 equivalent) */
            --yale-blue-dark: #0A3161; /* Lower intensity blue (PMS 654 equivalent) */
            --yale-gray: #A6A6A6; /* Yale's Warm Gray (PMS Warm Gray 7 equivalent) */
            
            /* Core Color Palette - Using Yale colors with light mode */
            --bg-primary: #FFFFFF; /* White background - Yale's primary background color */
            --bg-secondary: #F5F7FA; /* Light gray/blue background for secondary elements */
            --bg-tertiary: #EDF2F7; /* Slightly darker background for tertiary elements */
            --accent-blue-primary: var(--yale-blue);
            --accent-blue-secondary: var(--yale-blue-light);
            --accent-amber-primary: #BD5319; /* Yale's complementary accent color */
            --accent-amber-secondary: #F8C23E; /* Brighter yellow for contrast */
            
            /* Status Colors - WCAG 2.1 compliant with good contrast ratio */
            --status-green: #2E7D32; /* 4.5:1 contrast ratio against light backgrounds */
            --status-amber: #BD5319; /* Yale's complementary accent color */
            --status-red: #C62828; /* 4.5:1 contrast ratio against light backgrounds */
            --status-low: rgba(46, 125, 50, 0.95);
            --status-medium: rgba(189, 83, 25, 0.95); /* Using Yale complementary */
            --status-high: rgba(198, 40, 40, 0.95);
            --status-critical: rgba(198, 40, 40, 1);
            
            /* Text Colors - Enhanced for WCAG 2.1 AA compliance (4.5:1 min contrast ratio) */
            --text-primary: #212121; /* Dark gray - nearly black (15.6:1 contrast with white) */
            --text-secondary: #4A5568; /* Medium gray (7.8:1 contrast with white) */
            --text-muted: #718096; /* Light gray (4.6:1 contrast with white) */
            --text-highlight: var(--yale-blue); /* Using Yale Blue for highlighted text */
            
            /* Border and Shadow - Adjusted for light mode */
            --border-light: #E2E8F0; /* Light gray border */
            --card-shadow: 0 2px 8px rgba(0, 0, 0, 0.1); /* Lighter shadow for light mode */
            --card-depth: 0 1px 3px rgba(0, 0, 0, 0.1), 0 1px 2px rgba(0, 0, 0, 0.06); /* Subtle depth for cards */
            
            /* Interaction - Enhanced for accessibility */
            --hover-overlay: rgba(0, 53, 107, 0.05); /* Yale blue hover with slight transparency */
            --active-overlay: rgba(0, 53, 107, 0.1); /* Yale blue active with slight transparency */
            --focus-ring: 0 0 0 3px rgba(40, 109, 192, 0.5); /* Yale blue light with transparency for focus */
            
            /* Animation */
            --transition-standard: 300ms cubic-bezier(0.4, 0, 0.2, 1);
            --transition-enter: 300ms cubic-bezier(0.0, 0, 0.2, 1);
            --transition-exit: 250ms cubic-bezier(0.4, 0, 1, 1);
        }
        
        body {
            font-family: "Open Sans", system-ui, -apple-system, sans-serif;
            background-color: var(--bg-primary);
            color: var(--text-primary);
            line-height: 1.5;
            margin: 0;
            padding: 0;
            letter-spacing: 0.01em;
        }
        
        /* Grid and Layout */
        .app-container {
            max-width: 1440px;
            margin: 0 auto;
            padding: 0.5rem;
        }
        
        /* Card Components - Adjusted for light mode */
        .card {
            background-color: white;
            border: 1px solid var(--border-light);
            border-radius: 4px;
            overflow: hidden;
            box-shadow: var(--card-shadow);
        }
        
        /* Typography - Enhanced for mobile and desktop */
        h1, h2, h3, h4, h5, h6 {
            color: var(--yale-blue); /* Yale blue headers provide strong contrast and match branding */
            font-weight: 600;
            margin-top: 0;
            line-height: 1.3; /* Increased line height for better readability */
        }
        
        /* Mobile-first typography with responsive sizing */
        h1 { font-size: 1.5rem; letter-spacing: -0.01em; }
        h2 { font-size: 1.35rem; letter-spacing: -0.01em; }
        h3 { font-size: 1.2rem; }
        h4 { font-size: 1.1rem; }
        h5 { font-size: 1rem; text-transform: uppercase; letter-spacing: 0.05em; }
        h6 { font-size: 0.9rem; text-transform: uppercase; letter-spacing: 0.05em; }
        
        /* Desktop typography adjustments */
        @media (min-width: 768px) {
            h1 { font-size: 1.75rem; }
            h2 { font-size: 1.5rem; }
            h3 { font-size: 1.25rem; }
            h4 { font-size: 1.125rem; }
            h5 { font-size: 1rem; }
            h6 { font-size: 0.875rem; }
        }
        
        .text-mono {
            font-family: "SF Mono", "JetBrains Mono", "Roboto Mono", Menlo, Consolas, monospace;
            font-size: 0.9em;
            letter-spacing: -0.02em;
        }
        
        /* Buttons */
        .btn-primary {
            background-color: var(--accent-blue-primary);
            color: white; /* Always white text on Yale blue for best contrast */
            border: none;
            border-radius: 3px;
            font-weight: 600; /* Increased from 500 for better readability */
            padding: 0.5rem 1rem;
            cursor: pointer;
            transition: background-color var(--transition-standard);
            text-align: center;
            line-height: 1.2;
            min-height: 44px; /* Increased from 36px for better touch target size (WCAG 2.1) */
            display: inline-flex;
            align-items: center;
            justify-content: center;
            font-size: 1rem; /* Ensuring minimum text size for readability */
        }
        
        .btn-primary:hover {
            background-color: var(--accent-blue-secondary);
        }
        
        .btn-primary:focus {
            outline: none;
            box-shadow: var(--focus-ring);
        }
        
        .btn-secondary {
            background-color: var(--bg-tertiary);
            color: var(--yale-blue); /* Using Yale blue for text color on light backgrounds */
            border: 1px solid var(--border-light);
            border-radius: 3px;
            font-weight: 600; /* Increased from 500 for better readability */
            padding: 0.5rem 1rem;
            cursor: pointer;
            transition: all var(--transition-standard);
            min-height: 44px; /* Increased for WCAG 2.1 touch target size */
            display: inline-flex;
            align-items: center;
            justify-content: center;
            font-size: 1rem; /* Ensuring minimum text size for readability */
        }
        
        .btn-secondary:hover {
            background-color: var(--bg-secondary);
            border-color: var(--yale-blue);
        }
        
        .btn-secondary:focus {
            outline: none;
            box-shadow: var(--focus-ring);
            border-color: var(--yale-blue-light);
        }
        
        .btn-outline {
            background-color: transparent;
            color: var(--yale-blue);
            border: 1px solid var(--yale-blue);
            border-radius: 3px;
            font-weight: 600; /* Increased from 500 for better readability */
            padding: 0.5rem 1rem;
            cursor: pointer;
            transition: all var(--transition-standard);
            min-height: 44px; /* Consistent with other buttons */
            display: inline-flex;
            align-items: center;
            justify-content: center;
        }
        
        .btn-outline:hover {
            background-color: rgba(0, 53, 107, 0.05); /* Yale blue with low opacity */
        }
        
        .btn-outline:focus {
            outline: none;
            box-shadow: var(--focus-ring);
        }
        
        /* Inputs - Adjusted for light mode */
        .search-input {
            background-color: white;
            border: 1px solid var(--border-light);
            border-radius: 3px;
            padding: 0.5rem 1rem;
            width: 100%;
            color: var(--text-primary);
            transition: all var(--transition-standard);
            min-height: 44px; /* Consistent height for better UX */
        }
        
        .search-input:focus {
            outline: none;
            border-color: var(--yale-blue);
            box-shadow: var(--focus-ring);
        }
        
        .search-input::placeholder {
            color: var(--text-muted);
        }
        
        .select-input {
            background-color: white;
            border: 1px solid var(--border-light);
            border-radius: 3px;
            padding: 0.5rem 2rem 0.5rem 0.75rem;
            color: var(--text-primary);
            appearance: none;
            background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3e%3cpath stroke='%2300356B' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='M6 8l4 4 4-4'/%3e%3c/svg%3e");
            background-position: right 0.5rem center;
            background-repeat: no-repeat;
            background-size: 1.25em 1.25em;
            transition: all var(--transition-standard);
            min-height: 44px; /* Consistent height for accessibility */
        }
        
        .select-input:focus {
            outline: none;
            border-color: var(--yale-blue);
            box-shadow: var(--focus-ring);
        }
        
        option {
            background-color: white;
            color: var(--text-primary);
            padding: 0.5rem;
        }
        
        /* Data Table - Adjusted for light mode */
        .data-table {
            width: 100%;
            border-collapse: separate;
            border-spacing: 0;
            box-shadow: var(--card-shadow);
            border-radius: 4px;
            overflow: hidden;
        }
        
        .data-table th {
            background-color: var(--yale-blue);
            font-weight: 600;
            font-size: 0.75rem;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            color: white; /* White text on Yale blue for best contrast */
            padding: 0.75rem 1rem;
            text-align: left;
            position: sticky;
            top: 0;
        }
        
        .data-table td {
            padding: 1.25rem 1rem; /* Increased vertical padding for more breathing room */
            border-bottom: 1px solid var(--border-light);
            vertical-align: top;
            color: var(--text-primary);
            background-color: white; /* Ensuring white background for cells */
        }
        
        .data-table tr:hover td {
            background-color: var(--bg-secondary);
        }
        
        /* Status Badges - Enhanced for accessibility and mobile */
        .impact-badge {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            border-radius: 4px;
            padding: 0.35rem 0.8rem; /* Increased for better touch targets */
            font-size: 0.9rem; /* Increased for better readability on mobile */
            font-weight: 600; /* Enhanced for better contrast */
            line-height: 1.3;
            letter-spacing: 0.02em;
            min-height: 36px; /* Minimum height for touch targets */
        }
        
        @media (min-width: 768px) {
            .impact-badge {
                padding: 0.25rem 0.7rem;
                font-size: 0.875rem;
                min-height: 30px;
            }
        }
        
        .impact-critical {
            background-color: var(--status-critical);
            color: white; /* 11.5:1 contrast ratio - excellent */
            font-weight: 600; /* Enhanced for readability */
        }
        
        .impact-high {
            background-color: var(--status-high);
            color: white; /* 9.5:1 contrast ratio - excellent */
            font-weight: 600; /* Enhanced for readability */
        }
        
        .impact-medium {
            background-color: var(--status-medium);
            color: white; /* Changed to white from dark for better contrast */
            font-weight: 600; /* Enhanced for readability */
        }
        
        .impact-low {
            background-color: var(--status-low);
            color: white; /* 7:1 contrast ratio - excellent */
            font-weight: 600; /* Enhanced for readability */
        }
        
        .tag {
            display: inline-flex;
            align-items: center;
            background-color: var(--bg-tertiary);
            color: var(--text-primary);
            border: 1px solid var(--border-light);
            border-radius: 4px;
            padding: 0.3rem 0.6rem;
            font-size: 0.85rem;
            font-weight: 500;
            margin-right: 0.35rem;
            margin-bottom: 0.35rem;
            min-height: 32px; /* Better touch target size for mobile */
        }
        
        @media (min-width: 768px) {
            .tag {
                padding: 0.2rem 0.5rem;
                font-size: 0.75rem;
                margin-right: 0.25rem;
                margin-bottom: 0.25rem;
                min-height: unset;
            }
        }
        
        /* Modal Components - Adjusted for light mode */
        .modal-backdrop {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(0, 53, 107, 0.5); /* Yale blue with transparency */
            z-index: 50;
            display: flex;
            justify-content: center;
            align-items: center;
            backdrop-filter: blur(3px);
            transition: opacity var(--transition-enter);
        }
        
        .modal-backdrop.hidden {
            display: none;
        }
        
        .modal-content {
            width: 95%;
            max-width: 1000px;
            max-height: 90vh;
            overflow-y: auto;
            z-index: 51;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
            border-radius: 8px; /* Slightly increased roundness */
            background-color: white;
            border: 1px solid var(--border-light);
            animation: modalEnter var(--transition-enter);
        }
        
        @keyframes modalEnter {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .modal-header {
            position: sticky;
            top: 0;
            background-color: white;
            z-index: 2;
            border-bottom: 1px solid var(--border-light);
        }
        
        .modal-footer {
            position: sticky;
            bottom: 0;
            background-color: white;
            z-index: 2;
            border-top: 1px solid var(--border-light);
        }
        
        .close-button {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 2rem;
            height: 2rem;
            border-radius: 3px;
            background-color: var(--bg-tertiary);
            color: var(--yale-blue);
            transition: all var(--transition-standard);
            border: 1px solid var(--border-light);
            min-height: auto; /* Override other button min-height */
        }
        
        .close-button:hover {
            background-color: var(--accent-blue-primary);
            color: white;
            border-color: var(--accent-blue-primary);
        }
        
        .close-button:focus {
            outline: none;
            box-shadow: var(--focus-ring);
        }
        
        /* Tab Navigation - Improved for accessibility */
        .tab-button {
            padding: 0.75rem 1rem;
            font-weight: 600; /* Increased from 500 for better readability */
            font-size: 0.95rem; /* Specified for consistent sizing */
            color: var(--text-secondary);
            border-bottom: 2px solid transparent;
            transition: all var(--transition-standard);
            background: transparent;
            border-top: none;
            border-left: none;
            border-right: none;
            cursor: pointer;
            min-height: 44px; /* Ensures adequate touch target size for WCAG 2.1 */
            position: relative; /* For focus indicator */
        }
        
        .tab-button:hover {
            color: var(--text-primary);
        }
        
        .tab-button:focus {
            outline: none;
            box-shadow: inset 0 -3px 0 var(--yale-blue-light);
        }
        
        .tab-button.active {
            color: var(--yale-blue);
            border-bottom-color: var(--yale-blue);
            font-weight: 700; /* Increased from 600 for better distinction */
            background-color: rgba(0, 53, 107, 0.04); /* Very subtle background to highlight active tab */
        }
        
        /* Animations */
        .animated-fade-in {
            animation: fadeIn var(--transition-enter);
        }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        /* Data Visualization - Adjusted for light mode */
        .data-visualization {
            background-color: white;
            border: 1px solid var(--border-light);
            border-radius: 4px;
            overflow: hidden;
            box-shadow: var(--card-shadow);
        }
        
        /* Responsive Adjustments */
        @media (max-width: 768px) {
            .modal-content {
                width: 100%;
                max-height: 100vh;
                border-radius: 0;
            }
            
            .tab-button {
                padding: 0.5rem 0.75rem;
                font-size: 0.875rem;
            }
        }

        /* Notification Badges */
        .yale-badge {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            border-radius: 3px;
            padding: 0.25rem 0.7rem; /* Slightly increased for better readability */
            font-size: 0.875rem; /* Increased from 0.75rem for better readability */
            font-weight: 600; /* Increased from 500 for better readability */
            line-height: 1.2; /* Increased for better readability */
            letter-spacing: 0.02em;
        }
        
        .yale-tag {
            display: inline-flex;
            align-items: center;
            background-color: var(--bg-tertiary);
            border: 1px solid var(--border-light);
            border-radius: 3px;
            padding: 0.25rem 0.5rem;
            font-size: 0.75rem;
            font-weight: 500;
            color: var(--text-primary);
            margin-right: 0.25rem;
            margin-bottom: 0.25rem;
        }

        /* Toast Notifications */
        #toast-container {
            position: fixed;
            bottom: 1rem;
            right: 1rem;
            z-index: 100;
        }

        .animate-fade-in {
            animation: fadeIn var(--transition-enter);
        }

        .opacity-0 {
            opacity: 0;
            transition: opacity var(--transition-exit);
        }
        
        /* Accessible Focus Styles - Enhanced for WCAG 2.1 compliance */
        .user-is-tabbing :focus:not(.btn-primary):not(.btn-secondary):not(.btn-outline):not(.tab-button) {
            outline: none;
            box-shadow: var(--focus-ring);
        }
        
        /* Skip to content link removed */
        
        /* Header & Footer */
        .header {
            border-bottom: 1px solid var(--border-light);
            padding: 1rem 0;
        }
        
        .footer {
            border-top: 1px solid var(--border-light);
            padding: 1rem 0;
            color: var(--text-secondary);
        }
        
        /* Stats Cards - Adjusted for light mode */
        .stat-card {
            background-color: white;
            border: 1px solid var(--border-light);
            border-radius: 4px;
            padding: 1rem;
            display: flex;
            flex-direction: column;
            box-shadow: var(--card-shadow);
        }
        
        .stat-card h3 {
            color: var(--yale-blue);
            font-size: 0.75rem;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            margin-bottom: 0.5rem;
            font-weight: 600; /* Increased from 500 for better visibility */
        }
        
        .stat-card .value {
            color: var(--text-primary);
            font-size: 1.5rem;
            font-weight: 700; /* Increased from 600 for better emphasis */
            letter-spacing: -0.02em;
        }
        
        /* Connection Lines */
        .connection-line {
            stroke: var(--border-light);
            stroke-width: 1px;
            fill: none;
        }
        
        /* Loading Indicators */
        .loading-indicator {
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 2rem;
            color: var(--accent-blue-secondary);
        }
        
        /* Scrollbar Styling */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }
        
        ::-webkit-scrollbar-track {
            background: var(--bg-primary);
        }
        
        ::-webkit-scrollbar-thumb {
            background: var(--bg-tertiary);
            border-radius: 4px;
        }
        
        ::-webkit-scrollbar-thumb:hover {
            background: var(--border-light);
        }
        
        /* Screen Reader Only - Proper ARIA support */
        .sr-only {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            white-space: nowrap;
            border-width: 0;
        }
        
        /* For WCAG 2.1 keyboard focus - ensures focus indicators are visible */
        *:focus-visible {
            outline: 3px solid var(--yale-blue-light);
            outline-offset: 2px;
        }
    </style>
</head>
<body class="min-h-screen">
    <div class="app-container">
        <!-- Header: Clean, modern design -->
        <header class="header pt-5 pb-5 mb-6 bg-white border-b border-gray-200">
            <div class="w-full max-w-6xl mx-auto px-4">
                <!-- Top content with logo and title -->
                <div class="flex flex-col md:flex-row md:items-start justify-between gap-4 mb-0">
                    <!-- Left side: Logo and title -->
                    <div class="flex-shrink-0 md:w-3/5">
                        <div class="flex items-center mb-2">
                            <div class="w-8 h-8 rounded-sm mr-3 bg-accent-blue-primary flex items-center justify-center">
                                <i class="fas fa-file-alt text-white text-sm"></i>
                            </div>
                            <h1 class="text-xl md:text-2xl font-semibold tracking-tight text-accent-blue-primary">Higher Education Executive Order Tracker</h1>
                        </div>
                        <p class="text-text-primary text-sm ml-0 md:ml-11 mb-0">Powered by AI analysis for university regulatory compliance</p>
                    </div>
                    
                    <!-- Right side: Description -->
                    <div class="md:w-2/5 mt-3 md:mt-1">
                        <p class="text-text-secondary text-sm">
                            A specialized tool for analyzing Presidential Executive Orders and their potential impacts on higher education institutions, using AI to identify and categorize key policy implications.
                        </p>
                    </div>
                </div>
            </div>
        </header>
        
        <!-- Main content: Command Center Layout -->
        <div id="main-content" class="mb-4" tabindex="-1">
            <!-- Command Bar - Refined Academic Style -->
            <div class="card mb-6 border border-gray-200 rounded-sm shadow-sm overflow-hidden">
                <div class="bg-white border-b border-gray-200 p-0">
                    <div class="flex items-center h-10 px-4 bg-accent-blue-primary bg-opacity-5">
                        <p class="text-accent-blue-primary text-xs uppercase tracking-widest font-medium">Document Filters</p>
                    </div>
                </div>
                <div class="p-5 bg-white">
                    <div class="flex flex-col gap-4">
                        <!-- Search box - Academic style -->
                        <div class="relative flex-grow">
                            <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                                <i class="fas fa-search text-accent-blue-primary opacity-70 text-sm"></i>
                            </div>
                            <input type="text" id="search-input" placeholder="Search executive orders by keyword" 
                                   class="w-full border border-gray-300 rounded-sm py-2.5 pl-10 pr-3 text-gray-800 placeholder-gray-500 focus:border-accent-blue-primary focus:ring focus:ring-accent-blue-primary focus:ring-opacity-30 transition duration-200 outline-none" style="font-family: 'Inter', system-ui, sans-serif;" />
                        </div>
                        
                        <!-- Mobile filter toggle - Academic style -->
                        <div class="block lg:hidden mb-1">
                            <button id="mobile-filters-toggle" class="w-full border border-gray-300 rounded-sm py-2.5 px-4 flex items-center justify-center bg-white hover:bg-gray-50 transition duration-200" style="font-family: 'Inter', system-ui, sans-serif;">
                                <i class="fas fa-filter mr-2 text-accent-blue-primary"></i>
                                <span class="text-gray-800">Filter Documents</span>
                                <i class="fas fa-chevron-down ml-2 text-accent-blue-primary transition-transform duration-300" id="filter-toggle-icon"></i>
                            </button>
                        </div>
                        
                        <!-- Filter controls - Academic style filtering -->
                        <div id="filters-container" class="flex flex-col lg:flex-row gap-4 mt-1 lg:mt-0 hidden lg:flex">
                            <div class="relative w-full lg:w-auto flex-1">
                                <label for="filter-impact-level" class="block text-xs text-gray-600 mb-1.5 font-medium">Impact Priority</label>
                                <div class="relative">
                                    <select id="filter-impact-level" class="w-full appearance-none bg-white border border-gray-300 rounded-sm py-2 pl-3 pr-10 text-gray-800 focus:border-accent-blue-primary focus:ring focus:ring-accent-blue-primary focus:ring-opacity-30 transition duration-200 outline-none" style="font-family: 'Inter', system-ui, sans-serif;">
                                        <option value="">All Impact Levels</option>
                                        <option value="Critical">Critical</option>
                                        <option value="High">High</option>
                                        <option value="Medium">Medium</option>
                                        <option value="Low">Low</option>
                                    </select>
                                    <div class="absolute inset-y-0 right-0 flex items-center pr-2 pointer-events-none">
                                        <i class="fas fa-chevron-down text-accent-blue-primary text-xs opacity-70"></i>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="relative w-full lg:w-auto flex-1">
                                <label for="filter-university-area" class="block text-xs text-gray-600 mb-1.5 font-medium">University Domain</label>
                                <div class="relative">
                                    <select id="filter-university-area" class="w-full appearance-none bg-white border border-gray-300 rounded-sm py-2 pl-3 pr-10 text-gray-800 focus:border-accent-blue-primary focus:ring focus:ring-accent-blue-primary focus:ring-opacity-30 transition duration-200 outline-none" style="font-family: 'Inter', system-ui, sans-serif;">
                                        <option value="">All Impact Areas</option>
                                        <!-- Populated dynamically -->
                                    </select>
                                    <div class="absolute inset-y-0 right-0 flex items-center pr-2 pointer-events-none">
                                        <i class="fas fa-chevron-down text-accent-blue-primary text-xs opacity-70"></i>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="relative w-full lg:w-auto flex-1">
                                <label for="filter-category" class="block text-xs text-gray-600 mb-1.5 font-medium">Policy Category</label>
                                <div class="relative">
                                    <select id="filter-category" class="w-full appearance-none bg-white border border-gray-300 rounded-sm py-2 pl-3 pr-10 text-gray-800 focus:border-accent-blue-primary focus:ring focus:ring-accent-blue-primary focus:ring-opacity-30 transition duration-200 outline-none" style="font-family: 'Inter', system-ui, sans-serif;">
                                        <option value="">All Categories</option>
                                        <!-- Populated dynamically -->
                                    </select>
                                    <div class="absolute inset-y-0 right-0 flex items-center pr-2 pointer-events-none">
                                        <i class="fas fa-chevron-down text-accent-blue-primary text-xs opacity-70"></i>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="w-full lg:w-auto flex items-end">
                                <button id="clear-filters-btn" class="w-full lg:w-auto flex items-center justify-center px-4 py-2 border border-gray-300 rounded-sm bg-white hover:bg-gray-50 text-gray-700 transition duration-200" style="font-family: 'Inter', system-ui, sans-serif;">
                                    <i class="fas fa-times mr-2 text-accent-amber-primary"></i>
                                    <span>Reset Filters</span>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Data Grid - Refined Academic Style -->
            <div class="card overflow-hidden border border-gray-200 rounded-sm shadow-sm">
                <div class="border-b border-gray-200 bg-white">
                    <div class="flex justify-between items-center h-10 px-4 bg-accent-blue-primary bg-opacity-5">
                        <h5 class="text-accent-blue-primary text-xs uppercase tracking-widest font-medium flex items-center">
                            <i class="fas fa-book-open mr-2 text-accent-blue-primary opacity-80"></i>
                            Executive Order Repository
                        </h5>
                        <div class="text-xs text-gray-600 flex items-center">
                            <span style="font-family: 'Georgia', serif;" class="text-accent-blue-primary font-medium mr-1" id="filtered-count">--</span> 
                            <span>documents found</span>
                        </div>
                    </div>
                </div>
                <!-- Mobile card view (visible on small screens) -->
                <div id="mobile-card-view" class="block lg:hidden">
                    <div id="mobile-eo-cards" class="space-y-4 p-2">
                        <div class="flex flex-col items-center py-8">
                            <i class="fas fa-spinner fa-spin text-accent-blue-secondary text-xl mb-3"></i>
                            <p class="text-text-secondary uppercase tracking-wider text-sm">Retrieving intelligence data</p>
                        </div>
                    </div>
                </div>
                
                <!-- Desktop table view (visible on large screens) -->
                <div class="hidden lg:block overflow-x-auto">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th scope="col" data-sort="order_number" class="cursor-pointer">
                                    <div class="flex items-center">
                                        <span>ID CODE</span>
                                        <i class="fas fa-sort ml-2 text-text-muted"></i>
                                    </div>
                                </th>
                                <th scope="col" data-sort="title" class="cursor-pointer">
                                    <div class="flex items-center">
                                        <span>DIRECTIVE</span>
                                        <i class="fas fa-sort ml-2 text-text-muted"></i>
                                    </div>
                                </th>
                                <th scope="col" data-sort="signing_date" class="cursor-pointer">
                                    <div class="flex items-center">
                                        <span>EXECUTION DATE</span>
                                        <i class="fas fa-sort-down ml-2 text-accent-blue-secondary"></i>
                                    </div>
                                </th>
                                <th scope="col" data-sort="impact_level" class="cursor-pointer">
                                    <div class="flex items-center">
                                        <span>PRIORITY LEVEL</span>
                                        <i class="fas fa-sort ml-2 text-text-muted"></i>
                                    </div>
                                </th>
                                <th scope="col">AFFECTED DOMAINS</th>
                                <th scope="col" class="text-right">OPERATIONS</th>
                            </tr>
                        </thead>
                        <tbody id="eo-table-body">
                            <tr>
                                <td colspan="6" class="text-center py-12">
                                    <div class="flex flex-col items-center loading-indicator">
                                        <i class="fas fa-spinner fa-spin text-accent-blue-secondary text-xl mb-3"></i>
                                        <p class="text-text-secondary uppercase tracking-wider text-sm">Retrieving intelligence data</p>
                                    </div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
        
        <!-- Tactical Information View (hidden by default) -->
        <div id="detail-view" class="modal-backdrop hidden">
            <div class="modal-content">
                <!-- Modal Header - Command Console Style -->
                <div class="modal-header p-4">
                    <div class="flex items-center justify-between">
                        <div class="flex items-center">
                            <div class="w-4 h-4 bg-accent-blue-secondary mr-3"></div>
                            <h3 id="detail-title" class="text-lg font-medium"></h3>
                        </div>
                        <button id="close-detail-btn" class="close-button" aria-label="Close details view">
                            <i class="fas fa-times" aria-hidden="true"></i>
                        </button>
                    </div>
                    
                    <div class="mt-2 mb-4 flex items-center text-xs text-text-secondary bg-bg-tertiary p-2 border border-border-light rounded">
                        <div class="flex items-center mr-4">
                            <span class="text-text-muted uppercase mr-2">ID:</span>
                            <span id="detail-order-number" class="font-mono text-text-primary"></span>
                        </div>
                        <div class="flex items-center mr-4">
                            <span class="text-text-muted uppercase mr-2">AUTHOR:</span>
                            <span id="detail-president" class="font-mono text-text-primary"></span>
                        </div>
                        <div class="flex items-center">
                            <span class="text-text-muted uppercase mr-2">TIMESTAMP:</span>
                            <span id="detail-date" class="font-mono text-text-primary"></span>
                        </div>
                    </div>
                    
                    <!-- Tabs - Desktop Version -->
                    <div class="hidden md:flex border-b border-border-light">
                        <button class="tab-button active" data-tab="summary" aria-selected="true" role="tab" aria-controls="summary-tab">
                            <i class="far fa-file-alt mr-2" aria-hidden="true"></i>SOURCE DATA
                        </button>
                        <button class="tab-button" data-tab="executive-brief" aria-selected="false" role="tab" aria-controls="executive-brief-tab">
                            <i class="fas fa-bolt mr-2" aria-hidden="true"></i>EXECUTIVE BRIEF
                        </button>
                        <button class="tab-button" data-tab="plain-summary" aria-selected="false" role="tab" aria-controls="plain-summary-tab">
                            <i class="fas fa-file-alt mr-2" aria-hidden="true"></i>STANDARD ANALYSIS
                        </button>
                        <button class="tab-button" data-tab="comprehensive-analysis" aria-selected="false" role="tab" aria-controls="comprehensive-analysis-tab">
                            <i class="fas fa-search-plus mr-2" aria-hidden="true"></i>COMPREHENSIVE ANALYSIS
                        </button>
                    </div>
                    
                    <!-- Mobile Tabs - Dropdown Version -->
                    <div class="block md:hidden border-b border-border-light">
                        <div class="relative">
                            <button id="mobile-tab-selector" class="w-full py-3 px-4 border border-border-light rounded bg-bg-tertiary flex items-center justify-between">
                                <span id="current-tab-label"><i class="far fa-file-alt mr-2" aria-hidden="true"></i>SOURCE DATA</span>
                                <i class="fas fa-chevron-down"></i>
                            </button>
                            <div id="mobile-tab-dropdown" class="absolute z-20 left-0 right-0 bg-white border border-border-light rounded shadow-lg mt-1 hidden">
                                <button class="mobile-tab-option w-full text-left px-4 py-3 hover:bg-bg-tertiary active" data-tab="summary">
                                    <i class="far fa-file-alt mr-2" aria-hidden="true"></i>SOURCE DATA
                                </button>
                                <button class="mobile-tab-option w-full text-left px-4 py-3 hover:bg-bg-tertiary" data-tab="executive-brief">
                                    <i class="fas fa-bolt mr-2" aria-hidden="true"></i>EXECUTIVE BRIEF
                                </button>
                                <button class="mobile-tab-option w-full text-left px-4 py-3 hover:bg-bg-tertiary" data-tab="plain-summary">
                                    <i class="fas fa-file-alt mr-2" aria-hidden="true"></i>STANDARD ANALYSIS
                                </button>
                                <button class="mobile-tab-option w-full text-left px-4 py-3 hover:bg-bg-tertiary" data-tab="comprehensive-analysis">
                                    <i class="fas fa-search-plus mr-2" aria-hidden="true"></i>COMPREHENSIVE ANALYSIS
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Modal Body -->
                <div id="tab-content" class="p-4">
                    <!-- Summary Tab (active by default) -->
                    <div id="summary-tab" class="tab-content">
                        <div class="flex flex-col lg:flex-row gap-4">
                            <!-- Mobile operational metrics (top on mobile) -->
                            <div class="block lg:hidden w-full mb-4">
                                <div class="bg-bg-tertiary border border-border-light rounded mb-4">
                                    <div class="p-3 border-b border-border-light">
                                        <h5 class="uppercase tracking-wider text-sm font-medium">Key Information</h5>
                                    </div>
                                    <div class="p-4">
                                        <div class="mb-4">
                                            <h6 class="text-sm uppercase text-text-muted mb-2">Priority Level</h6>
                                            <div id="mobile-detail-impact-level" class="yale-badge"></div>
                                        </div>
                                        
                                        <div class="mb-4">
                                            <h6 class="text-sm uppercase text-text-muted mb-2">Classification Tags</h6>
                                            <div id="mobile-detail-categories" class="flex flex-wrap gap-1 mb-2"></div>
                                        </div>
                                        
                                        <div class="mb-4">
                                            <h6 class="text-sm uppercase text-text-muted mb-2">Affected Areas</h6>
                                            <div id="mobile-detail-impact-areas" class="flex flex-wrap gap-1"></div>
                                        </div>
                                    </div>
                                    
                                    <div class="p-3 border-t border-border-light">
                                        <a id="mobile-detail-url" href="#" target="_blank" class="btn-primary w-full py-3 px-4 flex items-center justify-center text-base">
                                            <i class="fas fa-external-link-alt mr-2"></i>ACCESS SOURCE
                                        </a>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Main summary content -->
                            <div class="flex-grow">
                                <div class="mb-6">
                                    <div class="flex items-center p-3 bg-bg-tertiary border-b border-t border-border-light mb-3">
                                        <i class="fas fa-info-circle text-accent-blue-secondary mr-2"></i>
                                        <h4 class="text-base sm:text-sm uppercase tracking-wider font-medium">Intelligence Abstract</h4>
                                    </div>
                                    <div class="bg-bg-tertiary p-4 border border-border-light rounded">
                                        <p id="detail-summary" class="text-text-primary text-base sm:text-sm leading-relaxed"></p>
                                    </div>
                                </div>
                                
                                <div class="mb-6">
                                    <div class="flex items-center p-3 bg-bg-tertiary border-b border-t border-border-light mb-3">
                                        <i class="fas fa-university text-accent-blue-secondary mr-2"></i>
                                        <h4 class="text-base sm:text-sm uppercase tracking-wider font-medium">University Impact Analysis</h4>
                                    </div>
                                    <div id="detail-university-impact-areas" class="grid grid-cols-1 md:grid-cols-2 gap-4"></div>
                                </div>
                            </div>
                            
                            <!-- Info panel (desktop only) -->
                            <div class="hidden lg:block w-full lg:w-64 shrink-0">
                                <div class="bg-bg-tertiary border border-border-light rounded mb-4">
                                    <div class="p-3 border-b border-border-light">
                                        <h5 class="uppercase tracking-wider text-xs font-medium">Operational Metrics</h5>
                                    </div>
                                    <div class="p-3">
                                        <div class="mb-4">
                                            <h6 class="text-xs uppercase text-text-muted mb-2">Priority Level</h6>
                                            <div id="detail-impact-level" class="yale-badge"></div>
                                        </div>
                                        
                                        <div class="mb-4">
                                            <h6 class="text-xs uppercase text-text-muted mb-2">Classification Tags</h6>
                                            <div id="detail-categories" class="flex flex-wrap gap-1 mb-2"></div>
                                        </div>
                                        
                                        <div class="mb-4">
                                            <h6 class="text-xs uppercase text-text-muted mb-2">Affected Areas</h6>
                                            <div id="detail-impact-areas" class="flex flex-wrap gap-1"></div>
                                        </div>
                                    </div>
                                    
                                    <div class="p-3 border-t border-border-light">
                                        <a id="detail-url" href="#" target="_blank" class="btn-primary w-full py-2 px-3 flex items-center justify-center text-sm">
                                            <i class="fas fa-external-link-alt mr-2"></i>ACCESS SOURCE
                                        </a>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Tactical Brief Tab -->
                    <div id="executive-brief-tab" class="tab-content hidden" role="tabpanel" aria-labelledby="executive-brief-tab">
                        <div id="executive-brief-content" class="mb-4">
                            <div class="loading-indicator py-12">
                                <div class="flex flex-col items-center">
                                    <i class="fas fa-spinner fa-spin text-accent-blue-secondary text-xl mb-3"></i>
                                    <p class="text-text-secondary uppercase tracking-wider text-xs">Retrieving tactical brief</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Standard Analysis Tab -->
                    <div id="plain-summary-tab" class="tab-content hidden" role="tabpanel" aria-labelledby="plain-summary-tab">
                        <div id="plain-summary-content" class="mb-4">
                            <div class="loading-indicator py-12">
                                <div class="flex flex-col items-center">
                                    <i class="fas fa-spinner fa-spin text-accent-blue-secondary text-xl mb-3"></i>
                                    <p class="text-text-secondary uppercase tracking-wider text-xs">Retrieving standard analysis</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Deep Intelligence Tab -->
                    <div id="comprehensive-analysis-tab" class="tab-content hidden" role="tabpanel" aria-labelledby="comprehensive-analysis-tab">
                        <div id="comprehensive-analysis-content" class="mb-4">
                            <div class="loading-indicator py-12">
                                <div class="flex flex-col items-center">
                                    <i class="fas fa-spinner fa-spin text-accent-blue-secondary text-xl mb-3"></i>
                                    <p class="text-text-secondary uppercase tracking-wider text-xs">Retrieving deep intelligence</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Modal Footer -->
                <div class="modal-footer p-3 flex justify-between items-center">
                    <div class="flex items-center text-xs">
                        <div class="w-2 h-2 bg-accent-blue-secondary rounded-full mr-2"></div>
                        <span class="text-text-secondary uppercase tracking-wider">POLICY ANALYSIS</span>
                    </div>
                    <button class="btn-secondary px-4 py-2 text-sm uppercase tracking-wider" onclick="document.getElementById('detail-view').classList.add('hidden')">
                        Close View
                    </button>
                </div>
            </div>
        </div>
        
        
        <!-- Footer - Military-grade precision -->
        <footer class="footer mt-8">
            <div class="flex flex-col md:flex-row justify-between items-center">
                <div class="flex items-center mb-4 md:mb-0">
                    <div class="flex items-center text-xs uppercase tracking-wider">
                        <div class="w-2 h-2 rounded-full bg-accent-blue-secondary mr-2"></div>
                        <span id="system-info">EXECUTIVE ORDER ANALYSIS SYSTEM | STATIC DEPLOYMENT</span>
                    </div>
                </div>
                <div class="flex items-center gap-6">
                    <div class="flex items-center text-xs">
                        <span class="text-text-muted">POWERED BY</span>
                        <i class="fas fa-brain text-accent-amber-secondary mx-2"></i>
                        <span class="text-text-secondary">CLAUDE INTELLIGENCE ENGINE</span>
                    </div>
                    <a href="https://github.com/yourusername/yale-executive-orders" class="flex items-center text-xs" target="_blank" rel="noopener noreferrer">
                        <i class="fab fa-github text-accent-blue-secondary mr-1"></i>
                        <span class="text-accent-blue-secondary">REPOSITORY</span>
                    </a>
                </div>
            </div>
        </footer>

        <!-- Toast container -->
        <div id="toast-container"></div>
    </div>
    
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // DOM elements
            const searchInput = document.getElementById('search-input');
            const filterCategory = document.getElementById('filter-category');
            const filterImpactLevel = document.getElementById('filter-impact-level');
            const filterUniversityArea = document.getElementById('filter-university-area');
            const clearFiltersBtn = document.getElementById('clear-filters-btn');
            const eoTableBody = document.getElementById('eo-table-body');
            const systemInfo = document.getElementById('system-info');
            const detailView = document.getElementById('detail-view');
            const closeDetailBtn = document.getElementById('close-detail-btn');
            const updateDate = document.getElementById('update-date');
            
            // Removed stat elements references
            
            // Detail view elements
            const detailTitle = document.getElementById('detail-title');
            const detailOrderNumber = document.getElementById('detail-order-number');
            const detailPresident = document.getElementById('detail-president');
            const detailDate = document.getElementById('detail-date');
            const detailSummary = document.getElementById('detail-summary');
            const detailImpactLevel = document.getElementById('detail-impact-level');
            const detailCategories = document.getElementById('detail-categories');
            const detailImpactAreas = document.getElementById('detail-impact-areas');
            const detailUniversityImpactAreas = document.getElementById('detail-university-impact-areas');
            const detailUrl = document.getElementById('detail-url');
            
            // Data storage
            let allExecutiveOrders = [];
            let metadata = {
                categories: [],
                impactAreas: [],
                universityImpactAreas: []
            };
            let statistics = {};
            let systemInfoData = {};
            let sortField = 'signing_date';
            let sortDirection = 'desc';
            
            // Element references for metrics (set to null since we removed the UI elements)
            const totalOrdersCount = null;
            const criticalImpactCount = null;
            const topImpactArea = null;
            const recentOrdersCount = null;
            
            // Tab handling
            const tabs = document.querySelectorAll('.tab-button');
            const tabContents = document.querySelectorAll('.tab-content');
            
            tabs.forEach(tab => {
                tab.addEventListener('click', () => {
                    // Remove active class from all tabs
                    tabs.forEach(t => t.classList.remove('active'));
                    
                    // Add active class to clicked tab
                    tab.classList.add('active');
                    
                    // Hide all tab contents
                    tabContents.forEach(content => content.classList.add('hidden'));
                    
                    // Show selected tab content
                    const tabName = tab.getAttribute('data-tab');
                    document.getElementById(`${tabName}-tab`).classList.remove('hidden');
                });
            });
            
            // Fetch system info
            async function getSystemInfo() {
                try {
                    const response = await fetch('data/system_info.json');
                    if (!response.ok) {
                        throw new Error('Failed to get system info');
                    }
                    
                    const data = await response.json();
                    systemInfoData = data;
                    
                    // Update system info
                    systemInfo.textContent = `${data.topicName} | Static Version`;
                    
                    // Update last updated date
                    const lastUpdated = new Date(data.lastUpdated);
                    updateDate.textContent = lastUpdated.toLocaleDateString();
                    
                    // Update order count in stats
                    totalOrdersCount.textContent = data.orderCount;
                    
                } catch (error) {
                    console.error('Error getting system info:', error);
                    systemInfo.textContent = 'Yale Executive Order Tracker | Static Version';
                }
            }
            
            // Fetch and display the plain language summary
            // Fetch and display the executive brief
            async function fetchExecutiveBrief(orderId) {
                try {
                    const executiveBriefContent = document.getElementById('executive-brief-content');
                    executiveBriefContent.innerHTML = `
                        <div class="flex justify-center items-center py-8">
                            <div class="flex flex-col items-center" aria-live="polite">
                                <i class="fas fa-spinner fa-spin text-blue-700 text-2xl mb-3" aria-hidden="true"></i>
                                <p class="text-gray-500">Loading executive brief...</p>
                            </div>
                        </div>
                    `;
                    
                    // Fetch the executive brief HTML file
                    const response = await fetch(`data/executive_briefs/${orderId}.html`);
                    
                    if (!response.ok) {
                        if (response.status === 404) {
                            // No brief available
                            executiveBriefContent.innerHTML = `
                                <div class="bg-gray-50 border border-gray-200 rounded-lg p-6 text-center">
                                    <i class="fas fa-file-alt text-gray-400 text-4xl mb-4" aria-hidden="true"></i>
                                    <h3 class="text-lg font-medium text-gray-800 mb-2">No Executive Brief Available</h3>
                                    <p class="text-gray-500">An executive brief has not been generated for this executive order yet.</p>
                                </div>
                            `;
                            return;
                        }
                        throw new Error(`Status: ${response.status}`);
                    }
                    
                    const htmlContent = await response.text();
                    
                    // Display the executive brief (which is already HTML formatted)
                    executiveBriefContent.innerHTML = htmlContent;
                    
                } catch (error) {
                    console.error('Error fetching executive brief:', error);
                    document.getElementById('executive-brief-content').innerHTML = `
                        <div class="bg-red-50 border border-red-200 rounded-lg p-6 text-center" role="alert">
                            <i class="fas fa-exclamation-circle text-red-500 text-4xl mb-4" aria-hidden="true"></i>
                            <h3 class="text-lg font-medium text-red-800 mb-2">Error Loading Brief</h3>
                            <p class="text-red-500">There was an error loading the executive brief. Please try again later.</p>
                        </div>
                    `;
                }
            }
            
            // Fetch and display the plain language summary (standard summary)
            async function fetchPlainLanguageSummary(orderId) {
                try {
                    const plainSummaryContent = document.getElementById('plain-summary-content');
                    plainSummaryContent.innerHTML = `
                        <div class="flex justify-center items-center py-8">
                            <div class="flex flex-col items-center" aria-live="polite">
                                <i class="fas fa-spinner fa-spin text-blue-700 text-2xl mb-3" aria-hidden="true"></i>
                                <p class="text-gray-500">Loading standard summary...</p>
                            </div>
                        </div>
                    `;
                    
                    // In static version, fetch the HTML file directly
                    const response = await fetch(`data/summaries/${orderId}.html`);
                    
                    if (!response.ok) {
                        if (response.status === 404) {
                            // No summary available
                            plainSummaryContent.innerHTML = `
                                <div class="bg-gray-50 border border-gray-200 rounded-lg p-6 text-center">
                                    <i class="fas fa-file-alt text-gray-400 text-4xl mb-4" aria-hidden="true"></i>
                                    <h3 class="text-lg font-medium text-gray-800 mb-2">No Standard Summary Available</h3>
                                    <p class="text-gray-500">A standard summary has not been generated for this executive order yet.</p>
                                </div>
                            `;
                            return;
                        }
                        throw new Error(`Status: ${response.status}`);
                    }
                    
                    const htmlContent = await response.text();
                    
                    // Transform the content into a properly formatted HTML with tailwind styling 
                    // instead of inline CSS to match the rest of the site's styling
                    const enhancedHtml = `
                        <div class="bg-white border border-gray-200 rounded-lg p-6">
                            <div class="mb-6 pb-4 border-b border-gray-200">
                                <h2 class="text-xl font-semibold text-blue-700 mb-3">Standard Analysis</h2>
                                <p class="text-gray-700 mb-4">A streamlined, actionable summary of the executive order's impacts on higher education.</p>
                            </div>
                            <div class="prose prose-blue max-w-none">
                                ${htmlContent}
                            </div>
                        </div>
                    `;
                    
                    // Display the enhanced standard summary
                    plainSummaryContent.innerHTML = enhancedHtml;
                    
                } catch (error) {
                    console.error('Error fetching standard summary:', error);
                    document.getElementById('plain-summary-content').innerHTML = `
                        <div class="bg-red-50 border border-red-200 rounded-lg p-6 text-center" role="alert">
                            <i class="fas fa-exclamation-circle text-red-500 text-4xl mb-4" aria-hidden="true"></i>
                            <h3 class="text-lg font-medium text-red-800 mb-2">Error Loading Summary</h3>
                            <p class="text-red-500">There was an error loading the standard summary. Please try again later.</p>
                        </div>
                    `;
                }
            }
            
            // Fetch and display the comprehensive analysis
            async function fetchComprehensiveAnalysis(orderId) {
                try {
                    const comprehensiveAnalysisContent = document.getElementById('comprehensive-analysis-content');
                    comprehensiveAnalysisContent.innerHTML = `
                        <div class="flex justify-center items-center py-8">
                            <div class="flex flex-col items-center" aria-live="polite">
                                <i class="fas fa-spinner fa-spin text-blue-700 text-2xl mb-3" aria-hidden="true"></i>
                                <p class="text-gray-500">Loading comprehensive analysis...</p>
                            </div>
                        </div>
                    `;
                    
                    // Fetch the comprehensive analysis HTML file
                    const response = await fetch(`data/comprehensive_analyses/${orderId}.html`);
                    
                    if (!response.ok) {
                        if (response.status === 404) {
                            // No analysis available
                            comprehensiveAnalysisContent.innerHTML = `
                                <div class="bg-gray-50 border border-gray-200 rounded-lg p-6 text-center">
                                    <i class="fas fa-file-alt text-gray-400 text-4xl mb-4" aria-hidden="true"></i>
                                    <h3 class="text-lg font-medium text-gray-800 mb-2">No Comprehensive Analysis Available</h3>
                                    <p class="text-gray-500">A comprehensive analysis has not been generated for this executive order yet.</p>
                                </div>
                            `;
                            return;
                        }
                        throw new Error(`Status: ${response.status}`);
                    }
                    
                    const htmlContent = await response.text();
                    
                    // Transform the content into a properly formatted HTML with tailwind styling
                    // instead of inline CSS to match the rest of the site's styling
                    const enhancedHtml = `
                        <div class="bg-white border border-gray-200 rounded-lg p-6">
                            <div class="mb-6 pb-4 border-b border-gray-200">
                                <h2 class="text-xl font-semibold text-blue-700 mb-3">Comprehensive Analysis</h2>
                                <p class="text-gray-700 mb-4">An in-depth analysis with strategic considerations, risk assessment, and detailed implementation guidance.</p>
                            </div>
                            <div class="prose prose-blue max-w-none">
                                ${htmlContent}
                            </div>
                        </div>
                    `;
                    
                    // Display the enhanced comprehensive analysis
                    comprehensiveAnalysisContent.innerHTML = enhancedHtml;
                    
                } catch (error) {
                    console.error('Error fetching comprehensive analysis:', error);
                    document.getElementById('comprehensive-analysis-content').innerHTML = `
                        <div class="bg-red-50 border border-red-200 rounded-lg p-6 text-center" role="alert">
                            <i class="fas fa-exclamation-circle text-red-500 text-4xl mb-4" aria-hidden="true"></i>
                            <h3 class="text-lg font-medium text-red-800 mb-2">Error Loading Analysis</h3>
                            <p class="text-red-500">There was an error loading the comprehensive analysis. Please try again later.</p>
                        </div>
                    `;
                }
            }
            
            // Load metadata (categories, impact areas, etc.)
            async function loadMetadata() {
                try {
                    const response = await fetch('data/metadata.json');
                    if (!response.ok) {
                        throw new Error('Failed to fetch metadata');
                    }
                    
                    metadata = await response.json();
                    
                    // Populate filter options
                    populateFilterOptions();
                    
                } catch (error) {
                    console.error('Error loading metadata:', error);
                    showToast('Error', 'Failed to load category data', 'error');
                }
            }
            
            // Load executive orders
            async function loadExecutiveOrders() {
                try {
                    const response = await fetch('data/executive_orders.json');
                    if (!response.ok) {
                        throw new Error('Failed to fetch executive orders');
                    }
                    
                    allExecutiveOrders = await response.json();
                    
                    // Render the table
                    renderExecutiveOrdersTable();
                    
                } catch (error) {
                    console.error('Error loading executive orders:', error);
                    eoTableBody.innerHTML = `
                        <tr>
                            <td colspan="6" class="text-center py-10 text-red-500">
                                <div class="flex flex-col items-center">
                                    <i class="fas fa-exclamation-circle text-red-500 text-2xl mb-3"></i>
                                    <p>Error loading executive orders. Please try again later.</p>
                                </div>
                            </td>
                        </tr>
                    `;
                }
            }
            
            // Update dashboard stats based on orders data
            function updateDashboardStats(orders) {
                if (!orders || !orders.length) return;
                
                // Count critical impact orders
                const criticalOrders = orders.filter(order => order.impact_level === 'Critical');
                criticalImpactCount.textContent = criticalOrders.length;
                
                // Update progress bar for critical alerts
                const criticalPercentage = (criticalOrders.length / orders.length) * 100;
                const criticalProgressBar = document.getElementById('critical-progress');
                if (criticalProgressBar) {
                    criticalProgressBar.style.width = criticalPercentage + '%';
                }
                
                // Find top university impact area
                const impactAreaCounts = {};
                orders.forEach(order => {
                    if (order.university_impact_areas && order.university_impact_areas.length) {
                        order.university_impact_areas.forEach(area => {
                            const areaName = typeof area === 'string' ? area : area.name;
                            impactAreaCounts[areaName] = (impactAreaCounts[areaName] || 0) + 1;
                        });
                    }
                });
                
                // Sort impact areas by count
                const sortedAreas = Object.entries(impactAreaCounts)
                    .sort((a, b) => b[1] - a[1]);
                
                if (sortedAreas.length) {
                    topImpactArea.textContent = sortedAreas[0][0].toUpperCase();
                } else {
                    topImpactArea.textContent = 'UNDEFINED';
                }
                
                // Count recent orders (last 90 days)
                const ninetyDaysAgo = new Date();
                ninetyDaysAgo.setDate(ninetyDaysAgo.getDate() - 90);
                
                const recentOrders = orders.filter(order => {
                    if (!order.signing_date) return false;
                    return new Date(order.signing_date) >= ninetyDaysAgo;
                });
                
                recentOrdersCount.textContent = recentOrders.length;
            }
            
            // Load statistics
            async function loadStatistics() {
                try {
                    const response = await fetch('data/statistics.json');
                    if (!response.ok) {
                        throw new Error('Failed to fetch statistics');
                    }
                    
                    statistics = await response.json();
                    
                } catch (error) {
                    console.error('Error loading statistics:', error);
                }
            }
            
            // Populate filter options from metadata
            function populateFilterOptions() {
                // Categories
                if (metadata.categories && metadata.categories.length) {
                    // Clear existing options (except the first one)
                    filterCategory.innerHTML = '<option value="">All Categories</option>';
                    
                    // Sort categories by name
                    const sortedCategories = metadata.categories.sort((a, b) => a.name.localeCompare(b.name));
                    
                    // Add new options
                    sortedCategories.forEach(category => {
                        const option = document.createElement('option');
                        option.value = category.name;
                        option.textContent = category.name;
                        filterCategory.appendChild(option);
                    });
                }
                
                // University impact areas
                if (metadata.universityImpactAreas && metadata.universityImpactAreas.length) {
                    // Clear existing options (except the first one)
                    filterUniversityArea.innerHTML = '<option value="">All Impact Areas</option>';
                    
                    // Sort university impact areas by name
                    const sortedAreas = metadata.universityImpactAreas.sort((a, b) => a.name.localeCompare(b.name));
                    
                    // Add new options
                    sortedAreas.forEach(area => {
                        const option = document.createElement('option');
                        option.value = area.name;
                        option.textContent = area.name;
                        filterUniversityArea.appendChild(option);
                    });
                }
            }
            
            // Render executive orders table
            function renderExecutiveOrdersTable() {
                // Get filter values
                const categoryFilter = filterCategory.value;
                const impactLevelFilter = filterImpactLevel.value;
                const universityAreaFilter = filterUniversityArea.value;
                const searchText = searchInput.value.toLowerCase();
                
                // Apply filters
                const filteredOrders = allExecutiveOrders.filter(order => {
                    // Category filter
                    if (categoryFilter && (!order.categories || !order.categories.includes(categoryFilter))) {
                        return false;
                    }
                    
                    // Impact level filter
                    if (impactLevelFilter && order.impact_level !== impactLevelFilter) {
                        return false;
                    }
                    
                    // University impact area filter
                    if (universityAreaFilter) {
                        if (!order.university_impact_areas || !order.university_impact_areas.length) {
                            return false;
                        }
                        
                        // Check if any of the impact areas match the filter
                        const hasMatchingArea = order.university_impact_areas.some(area => {
                            const areaName = typeof area === 'string' ? area : (area.name || '');
                            return areaName === universityAreaFilter;
                        });
                        
                        if (!hasMatchingArea) {
                            return false;
                        }
                    }
                    
                    // Search text filter
                    if (searchText) {
                        const searchFields = [
                            order.order_number,
                            order.title,
                            order.summary,
                            order.president
                        ].map(field => field ? field.toLowerCase() : '');
                        
                        return searchFields.some(field => field.includes(searchText));
                    }
                    
                    return true;
                });
                
                // Update filtered count display
                const filteredCount = document.getElementById('filtered-count');
                if (filteredCount) {
                    filteredCount.textContent = filteredOrders.length;
                }
                
                // Sort the orders
                filteredOrders.sort((a, b) => {
                    let aValue = a[sortField];
                    let bValue = b[sortField];
                    
                    // Handle null values
                    if (aValue === null || aValue === undefined) return 1;
                    if (bValue === null || bValue === undefined) return -1;
                    
                    // Format values for comparison
                    if (sortField === 'signing_date') {
                        aValue = new Date(aValue);
                        bValue = new Date(bValue);
                    }
                    
                    // Compare values
                    if (aValue < bValue) {
                        return sortDirection === 'asc' ? -1 : 1;
                    }
                    if (aValue > bValue) {
                        return sortDirection === 'asc' ? 1 : -1;
                    }
                    return 0;
                });
                
                // Clear the table body
                eoTableBody.innerHTML = '';
                
                // Check if we have any results
                if (filteredOrders.length === 0) {
                    eoTableBody.innerHTML = `
                        <tr>
                            <td colspan="6" class="text-center py-10">
                                <div class="flex flex-col items-center">
                                    <i class="fas fa-filter text-gray-400 text-2xl mb-3"></i>
                                    <p class="text-gray-500">No executive orders match the selected filters.</p>
                                    <button id="reset-filters" class="btn-secondary mt-3 px-3 py-1 text-sm">Reset Filters</button>
                                </div>
                            </td>
                        </tr>
                    `;
                    document.getElementById('reset-filters')?.addEventListener('click', () => {
                        clearFiltersBtn.click();
                    });
                    return;
                }
                
                // Add rows for each order
                filteredOrders.forEach(order => {
                    const row = document.createElement('tr');
                    row.className = 'hover:bg-gray-50';
                    
                    // Format date
                    const dateFormatted = order.signing_date ? 
                        new Date(order.signing_date).toLocaleDateString('en-US', {
                            year: 'numeric', 
                            month: 'short', 
                            day: 'numeric'
                        }) : 'N/A';
                    
                    // Determine impact level class
                    let impactBadgeClass = 'impact-medium';
                    if (order.impact_level === 'Critical') {
                        impactBadgeClass = 'impact-critical';
                    } else if (order.impact_level === 'High') {
                        impactBadgeClass = 'impact-high';
                    } else if (order.impact_level === 'Low') {
                        impactBadgeClass = 'impact-low';
                    }
                    
                    // Prepare the complete summary with "This executive order" removed from the beginning
                    let cleanSummary = '';
                    if (order.summary) {
                        cleanSummary = order.summary
                            .replace(/^This executive order\s+/i, '')  // Remove "This executive order" from start
                            .replace(/^This EO\s+/i, '')               // Also remove "This EO" if present
                            .replace(/^The executive order\s+/i, '');  // Also remove "The executive order" if present
                        
                        // Capitalize first letter
                        cleanSummary = cleanSummary.charAt(0).toUpperCase() + cleanSummary.slice(1);
                    }
                        
                    // Summary format badges removed since all orders have all formats
                    
                    // Create table row
                    row.innerHTML = `
                        <td class="font-medium">
                            ${order.order_number || 'N/A'}
                        </td>
                        <td>
                            <div>
                                <div class="font-medium text-blue-700 hover:text-blue-900 cursor-pointer view-details text-base mb-2" data-id="${order.id}">
                                    ${order.title || 'N/A'}
                                </div>
                                <p class="text-sm text-gray-600 leading-relaxed">${cleanSummary}</p>
                            </div>
                        </td>
                        <td class="text-gray-600 whitespace-nowrap">
                            ${dateFormatted}
                        </td>
                        <td>
                            <span class="impact-badge ${impactBadgeClass}">
                                ${order.impact_level || 'Unknown'}
                            </span>
                        </td>
                        <td>
                            <div class="flex flex-wrap gap-1">
                                ${order.university_impact_areas && order.university_impact_areas.length ? 
                                    order.university_impact_areas.slice(0, 2).map(area => {
                                        const areaName = typeof area === 'string' ? area : (area.name || '');
                                        return `<span class="tag">${areaName.split(' ')[0]}</span>`;
                                    }).join('') + 
                                    (order.university_impact_areas.length > 2 ? 
                                        `<span class="tag">+${order.university_impact_areas.length - 2}</span>` : '')
                                    : '<span class="text-gray-400 text-sm">None</span>'}
                            </div>
                        </td>
                        <td class="whitespace-nowrap">
                            <div class="flex gap-2">
                                <button class="btn-primary py-1 px-3 text-xs view-details" data-id="${order.id}" aria-label="View details for ${order.title}">
                                    <i class="fas fa-eye" aria-hidden="true"></i>
                                </button>
                                <a href="${order.url || '#'}" target="_blank" class="btn-secondary py-1 px-3 text-xs" title="View original source" aria-label="View original source for ${order.title}">
                                    <i class="fas fa-external-link-alt" aria-hidden="true"></i>
                                </a>
                            </div>
                        </td>
                    `;
                    
                    eoTableBody.appendChild(row);
                    
                    // Add event listeners for view details buttons
                    row.querySelectorAll('.view-details').forEach(button => {
                        button.addEventListener('click', () => {
                            const id = button.getAttribute('data-id');
                            navigateToAnalysisPage(id);
                        });
                    });
                });
            }
            
            // Focus trap for modal accessibility
            function setupFocusTrap(modalElement) {
                // Find all focusable elements
                const focusableElements = modalElement.querySelectorAll(
                    'button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])'
                );
                
                if (focusableElements.length === 0) return;
                
                const firstElement = focusableElements[0];
                const lastElement = focusableElements[focusableElements.length - 1];
                
                // Handle tab key in modal
                modalElement.addEventListener('keydown', function(e) {
                    if (e.key === 'Tab') {
                        // If shift+tab on first element, move to last element
                        if (e.shiftKey && document.activeElement === firstElement) {
                            e.preventDefault();
                            lastElement.focus();
                        } 
                        // If tab on last element, move to first element
                        else if (!e.shiftKey && document.activeElement === lastElement) {
                            e.preventDefault();
                            firstElement.focus();
                        }
                    }
                });
            }
            
            // View order details
            async function viewOrderDetails(id) {
                try {
                    // Get the order details from the allExecutiveOrders array
                    const order = allExecutiveOrders.find(o => o.id === parseInt(id, 10) || o.id === id);
                    
                    if (!order) {
                        throw new Error('Order not found');
                    }
                    
                    // Populate detail view
                    detailTitle.textContent = order.title;
                    detailOrderNumber.textContent = order.order_number;
                    detailPresident.textContent = order.president;
                    
                    // Format date
                    const dateFormatted = order.signing_date ? 
                        new Date(order.signing_date).toLocaleDateString('en-US', {
                            year: 'numeric', 
                            month: 'long', 
                            day: 'numeric'
                        }) : 'N/A';
                    
                    detailDate.textContent = dateFormatted;
                    
                    detailSummary.textContent = order.summary;
                    
                    // Set impact level badge
                    let impactBadgeClass = 'bg-blue-100 text-blue-800';
                    if (order.impact_level === 'Critical') {
                        impactBadgeClass = 'bg-red-100 text-red-800';
                    } else if (order.impact_level === 'High') {
                        impactBadgeClass = 'bg-yellow-100 text-yellow-800';
                    } else if (order.impact_level === 'Low') {
                        impactBadgeClass = 'bg-green-100 text-green-800';
                    }
                    
                    detailImpactLevel.className = `yale-badge ${impactBadgeClass}`;
                    detailImpactLevel.textContent = order.impact_level || 'Unknown';
                    
                    // Set categories
                    detailCategories.innerHTML = '';
                    if (order.categories && order.categories.length > 0) {
                        order.categories.forEach(category => {
                            const tag = document.createElement('span');
                            tag.className = 'yale-tag bg-blue-100 text-blue-800';
                            tag.textContent = category;
                            detailCategories.appendChild(tag);
                        });
                    } else {
                        detailCategories.textContent = 'No categories specified';
                    }
                    
                    // Set impact areas
                    detailImpactAreas.innerHTML = '';
                    if (order.impact_areas && order.impact_areas.length > 0) {
                        order.impact_areas.forEach(area => {
                            const tag = document.createElement('span');
                            tag.className = 'yale-tag bg-green-100 text-green-800';
                            tag.textContent = area;
                            detailImpactAreas.appendChild(tag);
                        });
                    } else {
                        detailImpactAreas.textContent = 'No impact areas specified';
                    }
                    
                    // Set university impact areas
                    detailUniversityImpactAreas.innerHTML = '';
                    if (order.university_impact_areas && order.university_impact_areas.length > 0) {
                        order.university_impact_areas.forEach(area => {
                            // Get area name (handle both string and object formats)
                            const areaName = typeof area === 'string' ? area : area.name;
                            const areaDescription = typeof area === 'object' && area.description ? area.description : '';
                            const areaNotes = typeof area === 'object' && area.notes ? area.notes : '';
                            
                            // Create university impact area card
                            const card = document.createElement('div');
                            card.className = 'border border-gray-200 rounded-lg p-4 bg-indigo-50';
                            
                            // Determine icon based on area name
                            let iconClass = 'fas fa-university';
                            if (areaName === 'Research Funding') {
                                iconClass = 'fas fa-flask';
                            } else if (areaName === 'Student Aid & Higher Education Finance') {
                                iconClass = 'fas fa-graduation-cap';
                            } else if (areaName === 'Administrative Compliance') {
                                iconClass = 'fas fa-clipboard-check';
                            } else if (areaName === 'Workforce & Employment Policy') {
                                iconClass = 'fas fa-users';
                            } else if (areaName === 'Public-Private Partnerships') {
                                iconClass = 'fas fa-handshake';
                            }
                            
                            card.innerHTML = `
                                <div class="flex items-center mb-2">
                                    <i class="${iconClass} text-[#00356B] mr-2"></i>
                                    <h5 class="font-medium">${areaName}</h5>
                                </div>
                                <p class="text-sm text-gray-700">
                                    This executive order will impact ${areaName.toLowerCase()} at Yale University. 
                                </p>
                                ${areaDescription ? `<p class="text-xs text-gray-500 mt-2">${areaDescription}</p>` : ''}
                                ${areaNotes ? `<p class="text-xs italic text-gray-600 mt-2 border-t border-gray-100 pt-2">${areaNotes}</p>` : ''}
                            `;
                            
                            detailUniversityImpactAreas.appendChild(card);
                        });
                    } else {
                        detailUniversityImpactAreas.innerHTML = '<p class="text-gray-500">No specific university impact areas identified for this executive order.</p>';
                    }
                    
                    // Set URL
                    detailUrl.href = order.url || '#';
                    
                    // Reset active tab to summary
                    document.querySelectorAll('.tab-button').forEach(tab => tab.classList.remove('active'));
                    document.querySelector('[data-tab="summary"]').classList.add('active');
                    
                    document.querySelectorAll('.tab-content').forEach(content => content.classList.add('hidden'));
                    document.getElementById('summary-tab').classList.remove('hidden');
                    
                    // Check which summary formats are available and set tab visibility
                    document.querySelectorAll('.tab-button').forEach(tabButton => {
                        const tabName = tabButton.getAttribute('data-tab');
                        
                        // Always show the original summary tab
                        if (tabName === 'summary') {
                            return;
                        }
                        
                        // For other tabs, check if the format is available
                        let isAvailable = false;
                        if (order.summary_formats_available) {
                            if (tabName === 'executive-brief') {
                                isAvailable = order.summary_formats_available.includes('executive_brief');
                            } else if (tabName === 'plain-summary') {
                                isAvailable = order.summary_formats_available.includes('standard');
                            } else if (tabName === 'comprehensive-analysis') {
                                isAvailable = order.summary_formats_available.includes('comprehensive');
                            }
                        }
                        
                        if (isAvailable) {
                            tabButton.style.display = 'block';
                            // Load the summary for this tab
                            if (tabName === 'executive-brief') {
                                fetchExecutiveBrief(order.id);
                            } else if (tabName === 'plain-summary') {
                                fetchPlainLanguageSummary(order.id);
                            } else if (tabName === 'comprehensive-analysis') {
                                fetchComprehensiveAnalysis(order.id);
                            }
                        } else {
                            tabButton.style.display = 'none';
                        }
                    });
                    
                    // Show detail view
                    detailView.classList.remove('hidden');
                    
                    // Set focus to the close button for accessibility
                    setTimeout(() => {
                        closeDetailBtn.focus();
                        // Setup focus trap for the modal
                        setupFocusTrap(detailView.querySelector('.modal-content'));
                    }, 100);
                    
                } catch (error) {
                    console.error('Error displaying order details:', error);
                    showToast('Error', 'Failed to load order details', 'error');
                }
            }
            
            // Toast notification function
            function showToast(title, message, type = 'info') {
                // Create toast container if it doesn't exist
                let toastContainer = document.getElementById('toast-container');
                if (!toastContainer) {
                    toastContainer = document.createElement('div');
                    toastContainer.id = 'toast-container';
                    toastContainer.className = 'fixed bottom-4 right-4 z-50 flex flex-col gap-2';
                    toastContainer.setAttribute('aria-live', 'polite');
                    toastContainer.setAttribute('role', 'status');
                    document.body.appendChild(toastContainer);
                }
                
                // Create toast element
                const toast = document.createElement('div');
                toast.className = 'card p-4 shadow-lg flex items-start gap-3 animate-fade-in max-w-md';
                toast.setAttribute('role', 'alert');
                
                // Set background based on type
                const bgColor = type === 'success' ? 'bg-green-50 border-l-4 border-green-500' :
                                type === 'error' ? 'bg-red-50 border-l-4 border-red-500' :
                                'bg-blue-50 border-l-4 border-blue-500';
                toast.classList.add(...bgColor.split(' '));
                
                // Icon based on type
                const icon = type === 'success' ? '<i class="fas fa-check-circle text-green-500" aria-hidden="true"></i>' :
                            type === 'error' ? '<i class="fas fa-exclamation-circle text-red-500" aria-hidden="true"></i>' :
                            '<i class="fas fa-info-circle text-blue-500" aria-hidden="true"></i>';
                
                toast.innerHTML = `
                    <div class="text-xl">
                        ${icon}
                    </div>
                    <div class="flex-1">
                        <h3 class="font-medium">${title}</h3>
                        <p class="text-sm text-gray-600">${message}</p>
                    </div>
                    <button class="text-gray-400 hover:text-gray-600 text-lg close-toast" aria-label="Close notification">
                        <i class="fas fa-times" aria-hidden="true"></i>
                    </button>
                `;
                
                // Add toast to container
                toastContainer.appendChild(toast);
                
                // Close button event
                toast.querySelector('.close-toast').addEventListener('click', () => {
                    toast.classList.add('opacity-0');
                    setTimeout(() => toast.remove(), 300);
                });
                
                // Auto remove after 5 seconds
                setTimeout(() => {
                    if (toast.parentNode) {
                        toast.classList.add('opacity-0');
                        setTimeout(() => toast.remove(), 300);
                    }
                }, 5000);
            }
            
            // Add event listeners for filters
            searchInput.addEventListener('input', renderExecutiveOrdersTable);
            filterCategory.addEventListener('change', renderExecutiveOrdersTable);
            filterImpactLevel.addEventListener('change', renderExecutiveOrdersTable);
            filterUniversityArea.addEventListener('change', renderExecutiveOrdersTable);
            
            // Clear filters button
            clearFiltersBtn.addEventListener('click', () => {
                searchInput.value = '';
                filterCategory.value = '';
                filterImpactLevel.value = '';
                filterUniversityArea.value = '';
                renderExecutiveOrdersTable();
            });
            
            // Close detail view
            closeDetailBtn.addEventListener('click', (e) => {
                e.preventDefault();
                e.stopPropagation();
                detailView.classList.add('hidden');
            });
            
            // Add event listeners for sorting
            document.querySelectorAll('th[data-sort]').forEach(th => {
                th.addEventListener('click', () => {
                    const field = th.dataset.sort;
                    
                    // Toggle sort direction or set to ascending if switching fields
                    if (field === sortField) {
                        sortDirection = sortDirection === 'asc' ? 'desc' : 'asc';
                    } else {
                        sortField = field;
                        sortDirection = 'asc';
                    }
                    
                    // Update UI to indicate sort direction
                    document.querySelectorAll('th[data-sort]').forEach(header => {
                        const icon = header.querySelector('i');
                        if (icon) {
                            icon.className = 'fas fa-sort ml-1 text-gray-400';
                        }
                    });
                    
                    const icon = th.querySelector('i');
                    if (icon) {
                        icon.className = `fas fa-sort-${sortDirection === 'asc' ? 'up' : 'down'} ml-1 text-blue-700`;
                    }
                    
                    // Re-render table
                    renderExecutiveOrdersTable();
                });
            });
            
            // Close detail view when clicking outside the modal
            detailView.addEventListener('click', (event) => {
                if (event.target === detailView) {
                    detailView.classList.add('hidden');
                }
            });
            
            // Close modal with escape key
            document.addEventListener('keydown', (event) => {
                if (event.key === 'Escape' && !detailView.classList.contains('hidden')) {
                    detailView.classList.add('hidden');
                }
            });
            
            // URL-based routing
            function handleUrlNavigation() {
                const urlParams = new URLSearchParams(window.location.search);
                const orderId = urlParams.get('order');
                
                if (orderId) {
                    // Attempt to open the specified order
                    viewOrderDetails(orderId);
                }
            }
            
            // Update URL when viewing details
            function updateUrl(orderId) {
                const url = new URL(window.location);
                if (orderId) {
                    url.searchParams.set('order', orderId);
                } else {
                    url.searchParams.delete('order');
                }
                window.history.pushState({}, '', url);
            }
            
            // Navigate to the analysis page
            function navigateToAnalysisPage(id) {
                const order = allExecutiveOrders.find(o => o.id === parseInt(id, 10) || o.id === id);
                if (!order) return;
                
                // Create slug from order title
                const slug = order.title.toLowerCase()
                                .replace(/[^\w\s-]/g, '')
                                .replace(/\s+/g, '-')
                                .replace(/-+/g, '-')
                                .trim();
                                
                // Navigate to analysis page with proper URL structure
                window.location.href = `analysis/index.html?id=${order.id}`;
            }
            
            // Add event listener for popstate (back/forward button)
            window.addEventListener('popstate', handleUrlNavigation);
            
            // Handle mobile filter toggle
            function setupMobileFilters() {
                const mobileFiltersToggle = document.getElementById('mobile-filters-toggle');
                const filtersContainer = document.getElementById('filters-container');
                const filterToggleIcon = document.getElementById('filter-toggle-icon');
                
                if (mobileFiltersToggle) {
                    mobileFiltersToggle.addEventListener('click', () => {
                        filtersContainer.classList.toggle('hidden');
                        filterToggleIcon.classList.toggle('transform');
                        filterToggleIcon.classList.toggle('rotate-180');
                    });
                }
            }
            
            // Handle mobile tab dropdown in detail view
            function setupMobileTabDropdown() {
                const mobileTabSelector = document.getElementById('mobile-tab-selector');
                const mobileTabDropdown = document.getElementById('mobile-tab-dropdown');
                const currentTabLabel = document.getElementById('current-tab-label');
                const mobileTabOptions = document.querySelectorAll('.mobile-tab-option');
                
                if (mobileTabSelector) {
                    // Toggle dropdown visibility
                    mobileTabSelector.addEventListener('click', (e) => {
                        e.stopPropagation();
                        mobileTabDropdown.classList.toggle('hidden');
                    });
                    
                    // Close dropdown when clicking outside
                    document.addEventListener('click', (e) => {
                        if (!mobileTabSelector.contains(e.target) && !mobileTabDropdown.contains(e.target)) {
                            mobileTabDropdown.classList.add('hidden');
                        }
                    });
                    
                    // Handle tab selection
                    mobileTabOptions.forEach(option => {
                        option.addEventListener('click', () => {
                            const tabName = option.getAttribute('data-tab');
                            const tabLabel = option.textContent.trim();
                            
                            // Update current tab label
                            currentTabLabel.innerHTML = option.innerHTML;
                            
                            // Hide dropdown
                            mobileTabDropdown.classList.add('hidden');
                            
                            // Trigger the corresponding desktop tab click
                            document.querySelector(`.tab-button[data-tab="${tabName}"]`).click();
                            
                            // Update active state in dropdown
                            mobileTabOptions.forEach(opt => opt.classList.remove('active'));
                            option.classList.add('active');
                        });
                    });
                }
            }
            
            // Create mobile cards for executive orders
            function renderMobileCards(filteredOrders) {
                const mobileCardsContainer = document.getElementById('mobile-eo-cards');
                
                if (!mobileCardsContainer) return;
                
                // Clear the container
                mobileCardsContainer.innerHTML = '';
                
                // Check if we have any results
                if (filteredOrders.length === 0) {
                    mobileCardsContainer.innerHTML = `
                        <div class="p-4 text-center">
                            <div class="flex flex-col items-center">
                                <i class="fas fa-filter text-gray-400 text-2xl mb-3"></i>
                                <p class="text-gray-500 mb-3">No executive orders match the selected filters.</p>
                                <button id="mobile-reset-filters" class="btn-secondary px-4 py-2 text-sm">Reset Filters</button>
                            </div>
                        </div>
                    `;
                    document.getElementById('mobile-reset-filters')?.addEventListener('click', () => {
                        clearFiltersBtn.click();
                    });
                    return;
                }
                
                // Create card for each order
                filteredOrders.forEach(order => {
                    // Format date
                    const dateFormatted = order.signing_date ? 
                        new Date(order.signing_date).toLocaleDateString('en-US', {
                            year: 'numeric', 
                            month: 'short', 
                            day: 'numeric'
                        }) : 'N/A';
                    
                    // Determine impact level class
                    let impactBadgeClass = 'impact-medium';
                    if (order.impact_level === 'Critical') {
                        impactBadgeClass = 'impact-critical';
                    } else if (order.impact_level === 'High') {
                        impactBadgeClass = 'impact-high';
                    } else if (order.impact_level === 'Low') {
                        impactBadgeClass = 'impact-low';
                    }
                    
                    // Prepare the complete summary with "This executive order" removed
                    let cleanSummary = '';
                    if (order.summary) {
                        cleanSummary = order.summary
                            .replace(/^This executive order\s+/i, '')
                            .replace(/^This EO\s+/i, '')
                            .replace(/^The executive order\s+/i, '');
                        
                        // Capitalize first letter
                        cleanSummary = cleanSummary.charAt(0).toUpperCase() + cleanSummary.slice(1);
                        
                        // Truncate if too long for card view
                        if (cleanSummary.length > 160) {
                            cleanSummary = cleanSummary.substring(0, 157) + '...';
                        }
                    }
                    
                    // Create mobile card
                    const card = document.createElement('div');
                    card.className = 'bg-white border border-border-light rounded-lg shadow-sm p-4';
                    
                    card.innerHTML = `
                        <div class="flex items-center justify-between mb-3">
                            <div class="text-xs text-text-muted font-mono">${order.order_number || 'N/A'}</div>
                            <div class="text-xs text-text-muted">${dateFormatted}</div>
                        </div>
                        
                        <h3 class="text-accent-blue-primary text-lg font-medium mb-2 view-details cursor-pointer" data-id="${order.id}">
                            ${order.title || 'N/A'}
                        </h3>
                        
                        <p class="text-text-secondary text-sm mb-4">${cleanSummary}</p>
                        
                        <div class="flex flex-wrap items-center gap-2 mb-4">
                            <span class="impact-badge ${impactBadgeClass}">
                                ${order.impact_level || 'Unknown'}
                            </span>
                            
                            ${order.university_impact_areas && order.university_impact_areas.length ? 
                                order.university_impact_areas.slice(0, 2).map(area => {
                                    const areaName = typeof area === 'string' ? area : (area.name || '');
                                    return `<span class="tag">${areaName.split(' ')[0]}</span>`;
                                }).join('') + 
                                (order.university_impact_areas.length > 2 ? 
                                    `<span class="tag">+${order.university_impact_areas.length - 2}</span>` : '')
                                : '<span class="text-gray-400 text-sm">No impact areas</span>'}
                        </div>
                        
                        <div class="flex justify-between">
                            <button class="btn-primary py-2 px-4 text-sm view-details" data-id="${order.id}">
                                View Details
                            </button>
                            <a href="${order.url || '#'}" target="_blank" class="btn-secondary py-2 px-4 text-sm" aria-label="View original source">
                                Source <i class="fas fa-external-link-alt ml-1"></i>
                            </a>
                        </div>
                    `;
                    
                    mobileCardsContainer.appendChild(card);
                    
                    // Add click event handlers for view details
                    card.querySelectorAll('.view-details').forEach(element => {
                        element.addEventListener('click', () => {
                            const id = element.getAttribute('data-id');
                            navigateToAnalysisPage(id);
                        });
                    });
                });
            }
            
            // Override the renderExecutiveOrdersTable function to also handle mobile cards
            const originalRenderExecutiveOrdersTable = renderExecutiveOrdersTable;
            renderExecutiveOrdersTable = function() {
                // Get filter values
                const categoryFilter = filterCategory.value;
                const impactLevelFilter = filterImpactLevel.value;
                const universityAreaFilter = filterUniversityArea.value;
                const searchText = searchInput.value.toLowerCase();
                
                // Apply filters
                const filteredOrders = allExecutiveOrders.filter(order => {
                    // Category filter
                    if (categoryFilter && (!order.categories || !order.categories.includes(categoryFilter))) {
                        return false;
                    }
                    
                    // Impact level filter
                    if (impactLevelFilter && order.impact_level !== impactLevelFilter) {
                        return false;
                    }
                    
                    // University impact area filter
                    if (universityAreaFilter) {
                        if (!order.university_impact_areas || !order.university_impact_areas.length) {
                            return false;
                        }
                        
                        // Check if any of the impact areas match the filter
                        const hasMatchingArea = order.university_impact_areas.some(area => {
                            const areaName = typeof area === 'string' ? area : (area.name || '');
                            return areaName === universityAreaFilter;
                        });
                        
                        if (!hasMatchingArea) {
                            return false;
                        }
                    }
                    
                    // Search text filter
                    if (searchText) {
                        const searchFields = [
                            order.order_number,
                            order.title,
                            order.summary,
                            order.president
                        ].map(field => field ? field.toLowerCase() : '');
                        
                        return searchFields.some(field => field.includes(searchText));
                    }
                    
                    return true;
                });
                
                // Update filtered count display
                const filteredCount = document.getElementById('filtered-count');
                if (filteredCount) {
                    filteredCount.textContent = filteredOrders.length;
                }
                
                // Sort the orders
                filteredOrders.sort((a, b) => {
                    let aValue = a[sortField];
                    let bValue = b[sortField];
                    
                    // Handle null values
                    if (aValue === null || aValue === undefined) return 1;
                    if (bValue === null || bValue === undefined) return -1;
                    
                    // Format values for comparison
                    if (sortField === 'signing_date') {
                        aValue = new Date(aValue);
                        bValue = new Date(bValue);
                    }
                    
                    // Compare values
                    if (aValue < bValue) {
                        return sortDirection === 'asc' ? -1 : 1;
                    }
                    if (aValue > bValue) {
                        return sortDirection === 'asc' ? 1 : -1;
                    }
                    return 0;
                });
                
                // Render desktop table (original function)
                originalRenderExecutiveOrdersTable.call(this);
                
                // Render mobile cards
                renderMobileCards(filteredOrders);
            };
            
            // Update view order details to handle mobile view panels
            const originalViewOrderDetails = viewOrderDetails;
            viewOrderDetails = async function(id) {
                await originalViewOrderDetails.call(this, id);
                
                // Sync mobile detail info with desktop
                const order = allExecutiveOrders.find(o => o.id === parseInt(id, 10) || o.id === id);
                if (order) {
                    // Mobile impact level
                    const mobileDetailImpactLevel = document.getElementById('mobile-detail-impact-level');
                    if (mobileDetailImpactLevel) {
                        mobileDetailImpactLevel.className = detailImpactLevel.className;
                        mobileDetailImpactLevel.textContent = detailImpactLevel.textContent;
                    }
                    
                    // Mobile categories
                    const mobileDetailCategories = document.getElementById('mobile-detail-categories');
                    if (mobileDetailCategories) {
                        mobileDetailCategories.innerHTML = detailCategories.innerHTML;
                    }
                    
                    // Mobile impact areas
                    const mobileDetailImpactAreas = document.getElementById('mobile-detail-impact-areas');
                    if (mobileDetailImpactAreas) {
                        mobileDetailImpactAreas.innerHTML = detailImpactAreas.innerHTML;
                    }
                    
                    // Mobile URL
                    const mobileDetailUrl = document.getElementById('mobile-detail-url');
                    if (mobileDetailUrl) {
                        mobileDetailUrl.href = detailUrl.href;
                    }
                }
            };
            
            // Initialize
            async function init() {
                await getSystemInfo();
                await loadMetadata();
                await loadExecutiveOrders();
                // We don't need to call loadStatistics() anymore since we removed the metrics dashboard
                setupMobileFilters();
                setupMobileTabDropdown();
                handleUrlNavigation();
            }
            
            init();
        });
    </script>
</body>
</html>